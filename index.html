<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
</head>
<body>
<script type="module">
import {
  packageWasmExports,
  createWasmLib
} from "./js/utils.js"

import {
  testWasm,
  showTestReport
} from "./js/wasmTest.js"

const SHOW_DETAIL = false

// -----------------------------------------------------------------------------
// Since WASM has no maths library of its own, log and trigonometric functions
// must be supplied by the host environment
let hostFunctions = {
  math: {
    sin   : Math.sin,
    cos   : Math.cos,
    sinh  : Math.sinh,
    cosh  : Math.cosh,
    ln    : Math.log,
    atan2 : Math.atan2
  }
}

// -----------------------------------------------------------------------------
// Create an instance of the WASM module, then pass it to the test framework
  createWasmLib('./complex.wasm', 'cplx', hostFunctions)
    .then(({wasmObj, cplxFns}) => {
      showTestReport(testWasm(wasmObj.instance), SHOW_DETAIL)
      // Object
      //   .keys(cplxFns.cplx)
      //   .map(fn => console.log(`${fn} : ${cplxFns.cplx[fn]}`))
    })

</script>
</body>
